<section class="page" *ngIf="symbol$ | async as sym">
  <div class="head">
    <div class="title-group">
      <a class="btn-back" routerLink="/dashboard">←</a>
      <h1>{{ sym }}</h1>
      <span class="tag" *ngIf="type$ | async as type" [class.crypto]="type === 'CRYPTO'">{{ type }}</span>
    </div>

    <div class="live-price" *ngIf="liveQuote$ | async as q">
      <span class="val">{{ q.price | number:'1.2-5' }} $</span>
      <span class="pct" [class.pos]="q.changePct >= 0" [class.neg]="q.changePct < 0">
        {{ q.changePct > 0 ? '+' : ''}}{{ q.changePct | number:'1.2-2' }}%
      </span>
    </div>
  </div>

  <div class="grid-layout">
    <div class="main-col">
      <div class="card chart-card">
        <div class="chart-container" #chartContainer></div>
      </div>

      <div class="card info-card" *ngIf="profile$ | async as p">
        <h2>{{ p.name }}</h2>
        <div class="badges">
          <span class="badge">{{ p.exchange }}</span>
          <span class="badge">{{ p.sector }}</span>
        </div>
        <p class="desc">{{ p.description }}</p>
      </div>
    </div>

    <div class="side-col">
      <div class="card news-card">
        <h2>Dernières News</h2>
        <div class="news-list" *ngIf="news$ | async as newsList; else loadingNews">
          <a *ngFor="let n of newsList" [href]="n.url" target="_blank" class="news-item">
            <div class="news-meta">{{ n.publishedDate | date:'short' }} • {{ n.source }}</div>
            <div class="news-title">{{ n.title }}</div>
          </a>
          <div *ngIf="newsList.length === 0" class="muted">Aucune news récente.</div>
        </div>
        <ng-template #loadingNews><div class="muted">Chargement des news...</div></ng-template>
      </div>
    </div>
  </div>
</section>